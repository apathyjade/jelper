"use strict";(self.webpackChunk_jelper_website=self.webpackChunk_jelper_website||[]).push([[2109],{5802:(e,r,s)=>{s.d(r,{Yb:()=>z,lC:()=>n,yK:()=>f,d7:()=>m,Um:()=>p,$$:()=>H,Bf:()=>E,aq:()=>d,gt:()=>v,JO:()=>b,xW:()=>i,wY:()=>M,ef:()=>T,nc:()=>c,BX:()=>o,Rx:()=>x,_g:()=>O,Z3:()=>k,RO:()=>g,iK:()=>h,UP:()=>u,h:()=>l});var t=s(9474);const n=e=>{const[r,s]=(0,t.useState)(e);return[r,(0,t.useCallback)((e=>{s(null==e?e=>!e:"boolean"==typeof e||"function"==typeof e?e:!!e)}),[])]},u=(e,r)=>{const s=(0,t.useRef)(!1);(0,t.useEffect)((()=>{if(s.current)return e();s.current=!0}),r)},a=(e,r)=>e===r,l=(e,r,s)=>{const{isEqual:n=a}=s||{},[l,i]=(0,t.useState)(e);return u((()=>{n(e,l)||null==r||r(l)}),[l]),u((()=>{n(e,l)||i(e)}),[e]),[l,i]},i=(e={})=>{const[r]=(0,t.useState)(e),[s,n]=(0,t.useState)(r),u=(0,t.useCallback)((()=>{n(r)}),[r]),a=(0,t.useCallback)((e=>{n((r=>Object.assign(Object.assign({},r),"function"==typeof e?e(r):e)))}),[]);return[s,{setOption:n,reset:u,update:a}]},o=e=>{const r=(0,t.useRef)(e);return r.current=e,r},c=e=>{const r=o(e);return(0,t.useCallback)(((...e)=>r.current(...e)),[])},d=()=>{const e=(0,t.useRef)(!1);return(0,t.useEffect)((()=>(e.current=!0,()=>{e.current=!1})),[]),(0,t.useCallback)((()=>e.current),[])},v=()=>{const e=(0,t.useRef)(!0);return(0,t.useEffect)((()=>(e.current=!1,()=>{e.current=!0})),[]),(0,t.useCallback)((()=>e.current),[])},f=e=>{(0,t.useState)(e)},b=e=>{(0,t.useEffect)(e,[])},h=e=>{const r=o(e);(0,t.useEffect)((()=>()=>{r.current()}),[])},p=(e,r=[],s)=>(0,t.useCallback)((r=>{var t;return"AbortError"===r.name?null===(t=null==s?void 0:s.onAbort)||void 0===t?void 0:t.call(s,r):e(r)}),r);var R=s(2935);const m=(e,r=200,s)=>{const n=c(e);return(0,t.useMemo)((()=>(0,R.debounce)(((...e)=>n(...e)),r,s)),[r,s])},O=(e,r=200,s)=>{const n=c(e);return(0,t.useMemo)((()=>(0,R.throttle)(((...e)=>{n(...e)}),r,s)),[r,s])},x=()=>{const e=v();return(0,t.useCallback)(((r,s)=>{e()?null==s||s():r()}),[])},j={immediate:!1,catchParam:!1},z=(e,r=Object.assign({},j))=>{const[s,n]=(0,t.useState)(void 0),[u,a]=(0,t.useState)(r.defParam||{}),[l,i]=(0,t.useState)(!1),[o,d]=(0,t.useState)(void 0),[b,p]=(0,t.useState)(),R=v();(0,t.useEffect)((()=>{if(!b||!r.onAbort)return;const e=r.onAbort;return b.signal.addEventListener("abort",e),()=>{b.signal.removeEventListener("abort",e)}}),[b]);const m=c(((s={})=>{const t=r.catchParam?Object.assign(Object.assign({},u),s):s;i(!0),d(void 0),b&&b.abort();const l=new AbortController;return p(l),e(t,{signal:l.signal}).then((e=>{R()||l.signal.aborted||(n(r.format?r.format(e):e),a(t))}),(e=>{R()||l.signal.aborted||d(e)})).finally((()=>{R()||(i(!1),p(void 0))}))})),O=c((()=>m(u)));return f((()=>{r.immediate&&m(u)})),h((()=>{b&&b.abort()})),[s,{run:m,refresh:O,loading:l,error:o,param:u,controller:b}]},g=()=>{const e=(0,t.useRef)(),r=(0,t.useCallback)((()=>{e.current&&(window.clearTimeout(e.current),e.current=void 0)}),[]),s=(0,t.useCallback)(((s,t,...n)=>{r(),e.current=window.setTimeout((()=>{e.current=void 0,s(...n)}),t)}),[]);return(0,t.useEffect)((()=>r)),[s,r]},k=(e,r,...s)=>{const[n,u]=g(),a=c(e);return(0,t.useEffect)((()=>(n(a,r,...s),u)),[a,r,...s]),u},E=()=>{const e=(0,t.useRef)(),r=(0,t.useCallback)((()=>{e.current&&(window.clearInterval(e.current),e.current=void 0)}),[]),s=(0,t.useCallback)(((s,t,...n)=>{r(),e.current=window.setInterval((()=>{s(...n)}),t)}),[]);return(0,t.useEffect)((()=>r)),[s,r]},H=(e,r,...s)=>{const[n,u]=E(),a=c(e);return(0,t.useEffect)((()=>(n(a,r,...s),u)),[a,r,...s]),u};let w,C,S=()=>{C=new Map,w=new window.ResizeObserver(((e=[])=>{e.forEach(((e={})=>{var r;null===(r=C.get(e.target))||void 0===r||r(e)}))})),S=null};const y=(e,r)=>{S&&S(),e&&(C.set(e,r),w.observe(e))},A=e=>{S&&S(),e&&(w.unobserve(e),C.delete(e))},T=()=>[y,A],M=(e,r)=>{const s=(0,t.useCallback)((()=>{e.current&&A(e.current)}),[e.current]);return(0,t.useEffect)((()=>{if(!e.current)return;const s=e.current;return y(s,r),()=>A(s)}),[e.current,r]),s}},7895:(e,r,s)=>{s.r(r),s.d(r,{assets:()=>h,contentTitle:()=>b,default:()=>m,frontMatter:()=>f,metadata:()=>t,toc:()=>p});const t=JSON.parse('{"id":"hooks/useResizeObserver/index","title":"useResizeObserver","description":"ResizeObserver \u4f7f\u7528hooks\uff0c\u63d0\u4f9b useEffect \u81ea\u52a8\u7ed1\u5b9a\u89e3\u7ed1\u65b9\u5f0f \u548c \u624b\u52a8\u7ed1\u5b9a\u65b9\u5f0f","source":"@site/docs/hooks/useResizeObserver/index.mdx","sourceDirName":"hooks/useResizeObserver","slug":"/hooks/useResizeObserver/","permalink":"/jelper/docs/hooks/useResizeObserver/","draft":false,"unlisted":false,"editUrl":"https://github.com/apathyjade/jelper/tree/master/packages/docs/hooks/useResizeObserver/index.mdx","tags":[],"version":"current","frontMatter":{"title":"useResizeObserver","sort":1},"sidebar":"tutorialSidebar","previous":{"title":"useOption","permalink":"/jelper/docs/hooks/useOption/"},"next":{"title":"useRtCb","permalink":"/jelper/docs/hooks/useRtCb/"}}');var n=s(3274),u=s(4252),a=s(6220),l=s(6016),i=s(9721),o=s(9474),c=s(1722),d=s(5802);const v=()=>{const[e,r]=(0,o.useState)(""),[s,t]=(0,o.useState)(""),u=(0,o.useRef)(null),a=(0,o.useRef)(null);(0,d.wY)(u,(e=>{r(`\u53d8\u66f4\u9ad8\u5ea6\u4e3a ${e.target.clientHeight}`)}));const[l,i]=(0,d.ef)();return(0,o.useEffect)((()=>(l(a.current,(e=>{t(`\u53d8\u66f4\u9ad8\u5ea6\u4e3a ${e.target.clientHeight}`)})),()=>i(a.current))),[]),(0,n.jsxs)(n.Fragment,{children:["useResizeObserver:",(0,n.jsx)("div",{ref:u,children:(0,n.jsx)(c.A.TextArea,{value:e})}),"useResizeObserverHandler:",(0,n.jsx)("div",{ref:a,children:(0,n.jsx)(c.A.TextArea,{value:s})})]})},f={title:"useResizeObserver",sort:1},b=void 0,h={},p=[{value:"\u5b89\u88c5",id:"\u5b89\u88c5",level:3},{value:"\u5f15\u5165",id:"\u5f15\u5165",level:3},{value:"\u6837\u4f8b",id:"\u6837\u4f8b",level:3},{value:"\u57fa\u7840\u7528\u6cd5",id:"\u57fa\u7840\u7528\u6cd5",level:4},{value:"API",id:"api",level:3},{value:"useResizeObserver",id:"useresizeobserver",level:4},{value:"Interface",id:"interface",level:3},{value:"UseResizeObserver",id:"useresizeobserver-1",level:4},{value:"UseResizeObserverHandler",id:"useresizeobserverhandler",level:4}];function R(e){const r={code:"code",h3:"h3",h4:"h4",p:"p",pre:"pre",...(0,u.R)(),...e.components};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(r.p,{children:"ResizeObserver \u4f7f\u7528hooks\uff0c\u63d0\u4f9b useEffect \u81ea\u52a8\u7ed1\u5b9a\u89e3\u7ed1\u65b9\u5f0f \u548c \u624b\u52a8\u7ed1\u5b9a\u65b9\u5f0f"}),"\n","\n",(0,n.jsx)(r.h3,{id:"\u5b89\u88c5",children:"\u5b89\u88c5"}),"\n",(0,n.jsx)(l.A,{name:"@jelper/hooks"}),"\n",(0,n.jsx)(r.h3,{id:"\u5f15\u5165",children:"\u5f15\u5165"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-tsx",children:"import { useResizeObserver } from '@jelper/hooks';\n"})}),"\n",(0,n.jsx)(r.h3,{id:"\u6837\u4f8b",children:"\u6837\u4f8b"}),"\n",(0,n.jsx)(r.h4,{id:"\u57fa\u7840\u7528\u6cd5",children:"\u57fa\u7840\u7528\u6cd5"}),"\n",(0,n.jsx)(a.A,{title:"\u57fa\u7840\u7528\u6cd5",desc:"",text:"\nimport React, { DOMElement, useEffect, useRef, useState } from 'react';\nimport { Input } from 'antd';\nimport { useResizeObserver, useResizeObserverHandler } from '@jelper/hooks';\n\nexport default () => {\n  const [val, setVal] = useState('');\n  const [valHandler, setValHandler] = useState('');\n  const ref = useRef<HTMLDivElement>(null);\n  const refHandler = useRef<HTMLDivElement>(null);\n\n  useResizeObserver(ref, (entry) => {\n    setVal(`\u53d8\u66f4\u9ad8\u5ea6\u4e3a ${entry.target.clientHeight}`);\n  });\n\n  const [observe, unobserve] = useResizeObserverHandler();\n\n  useEffect(() => {\n    observe(refHandler.current, (entry) => {\n      setValHandler(`\u53d8\u66f4\u9ad8\u5ea6\u4e3a ${entry.target.clientHeight}`);\n    });\n    return () => unobserve(refHandler.current);\n  }, []);\n\n  return <>\n    useResizeObserver:\n    <div ref={ref}>\n      <Input.TextArea  value={val}/>\n    </div>\n    useResizeObserverHandler:\n    <div ref={refHandler}>\n      <Input.TextArea  value={valHandler}/>\n    </div>\n  </>\n};\n",children:(0,n.jsx)(v,{})}),"\n",(0,n.jsx)(r.h3,{id:"api",children:"API"}),"\n",(0,n.jsx)(r.h4,{id:"useresizeobserver",children:"useResizeObserver"}),"\n",(0,n.jsx)(i.A,{dataSource:[{param:"useResizeObserver",desc:"\u76d1\u542cdom size\u53d8\u5316",type:"UseResizeObserver",defValue:"--",version:""},{param:"useResizeObserverHandler",desc:"\u76d1\u542cdom size\u53d8\u5316",type:"UseResizeObserverHandler",defValue:"--",version:""}]}),"\n",(0,n.jsx)(r.h3,{id:"interface",children:"Interface"}),"\n",(0,n.jsx)(r.h4,{id:"useresizeobserver-1",children:"UseResizeObserver"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-tsx",children:"type UseResizeObserver<T extends HTMLElement > = (\n  domRef: React.RefObject<T>,\n  cb: (dom: ResizeObserverEntry) => void\n) => (\n  () => void\n)\n"})}),"\n",(0,n.jsx)(r.h4,{id:"useresizeobserverhandler",children:"UseResizeObserverHandler"}),"\n",(0,n.jsx)(r.pre,{children:(0,n.jsx)(r.code,{className:"language-tsx",children:"type UseResizeObserverHandler = () => [\n  (target: HTMLElement, cb: (dom: ResizeObserverEntry) => void) => void, \n  (target: HTMLElement) => void\n]\n"})})]})}function m(e={}){const{wrapper:r}={...(0,u.R)(),...e.components};return r?(0,n.jsx)(r,{...e,children:(0,n.jsx)(R,{...e})}):R(e)}}}]);