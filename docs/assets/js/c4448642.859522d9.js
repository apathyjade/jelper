"use strict";(globalThis.webpackChunk_jelper_website=globalThis.webpackChunk_jelper_website||[]).push([[4422],{14269(e,n,o){o.r(n),o.d(n,{assets:()=>A,contentTitle:()=>R,default:()=>B,frontMatter:()=>E,metadata:()=>s,toc:()=>I});const s=JSON.parse('{"id":"context-composer/index","title":"context-composer","description":"React.Context \u751f\u6210\u5de5\u5177\uff0c\u5feb\u901f\u7ed1\u5b9a Provider \u548c React.useContext \u6570\u636e\u4f7f\u7528\uff0c\u540c\u65f6\u63d0\u4f9b\u591a React.Context \u5408\u5e76\u80fd\u529b","source":"@site/docs/context-composer/index.mdx","sourceDirName":"context-composer","slug":"/context-composer/","permalink":"/jelper/docs/context-composer/","draft":false,"unlisted":false,"editUrl":"https://github.com/apathyjade/jelper/tree/master/packages/docs/context-composer/index.mdx","tags":[],"version":"current","frontMatter":{"title":"context-composer","order":1},"sidebar":"tutorialSidebar","previous":{"title":"Row \u7ec4\u4ef6","permalink":"/jelper/docs/component/row/"},"next":{"title":"\u57fa\u7840\u6837\u5f0f\u7247\u6bb5","permalink":"/jelper/docs/css/"}}');var t=o(71137),r=o(99868),l=o(56374),a=o(82437),p=o(81671);const c=(e,n={})=>{const{builder:o}=n,s=a.createContext({});return{forwardComposer(n,r){const l=(0,a.memo)(n,r);return n=>{const r=e(n);return(0,t.jsx)(s.Provider,{value:r,children:o?o(n,l):(0,t.jsx)(l,Object.assign({},n))})}},useComposerCtx:()=>a.useContext(s),buildHooks:e=>(...n)=>{const o=a.useContext(s);return e(o)(...n)}}},i=c,d={builder:(e,n)=>(0,t.jsx)("div",{style:{border:e.hasBorder?"1px solid #f60":void 0,padding:"4px 12px"},children:(0,t.jsx)(n,{name:"base-api-test"})})},{forwardComposer:m,useComposerCtx:u}=i(e=>{const[n,o]=(0,a.useState)("light");return{glabalType:n,setGlabalType:o}},d),x=m(({name:e})=>{const{glabalType:n,setGlabalType:o}=u();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:["name: ",e??"--"]}),(0,t.jsxs)("div",{children:["glabalType: ",n]}),(0,t.jsx)(p.A,{value:n,onChange:e=>o(e.target.value)})]})}),C=()=>(0,t.jsx)(x,{hasBorder:!0}),{forwardComposer:g,useComposerCtx:h}=c(e=>{const[n,o]=(0,a.useState)("light");return{glabalType:n,setGlabalType:o}}),{forwardComposer:b,useComposerCtx:T}=c(e=>{const[n,o]=(0,a.useState)("light1");return{glabalType1:n,setGlabalType1:o}}),j=(v=[b,g],e=>v.reduce((e,n)=>o=>{const s=n(e);return(0,t.jsx)(s,Object.assign({},o))},e));var v;const y=()=>{const{glabalType:e,setGlabalType:n}=h();return(0,a.useEffect)(()=>{console.log("TestCom----\x3e useEffect")},[]),console.log("TestCom"),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:["glabalType: ",e]}),(0,t.jsx)(p.A,{value:e,onChange:e=>n(e.target.value)}),(0,t.jsx)("br",{})]})},f=()=>{const{glabalType1:e,setGlabalType1:n}=T();return(0,a.useEffect)(()=>{console.log("TestCom1----\x3e useEffect")},[]),console.log("TestCom1"),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:["glabalType1: ",e]}),(0,t.jsx)(p.A,{value:e,onChange:e=>n(e.target.value)}),(0,t.jsx)("br",{})]})},k=j(()=>((0,a.useEffect)(()=>{console.log("forwardComposer----\x3e useEffect")},[]),console.log("forwardComposer"),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(y,{}),(0,t.jsx)(f,{})]}))),{forwardComposer:w,useComposerCtx:P,buildHooks:G}=i(e=>{const[n,o]=(0,a.useState)("light");return{glabalType:n,setGlabalType:o}}),H=G(({glabalType:e,setGlabalType:n})=>o=>[e,n]),F=w(()=>{const[e,n]=H();return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{children:["glabalType: ",e]}),(0,t.jsx)(p.A,{value:e,onChange:e=>n(e.target.value)})]})});var S=o(44310);const E={title:"context-composer",order:1},R=void 0,A={},I=[{value:"\u5b89\u88c5",id:"\u5b89\u88c5",level:3},{value:"\u6837\u4f8b",id:"\u6837\u4f8b",level:3},{value:"\u5168\u5c40context\u4f7f\u7528",id:"\u5168\u5c40context\u4f7f\u7528",level:4},{value:"\u591acontext\u5408\u5e76\u4f7f\u7528",id:"\u591acontext\u5408\u5e76\u4f7f\u7528",level:4},{value:"buildHooks\u4f7f\u7528",id:"buildhooks\u4f7f\u7528",level:4},{value:"API",id:"api",level:3},{value:"createCtxComposer&lt;Props, T&gt;",id:"createctxcomposerprops-t",level:4},{value:"\u53c2\u6570",id:"\u53c2\u6570",level:5},{value:"\u8fd4\u56de\u503c",id:"\u8fd4\u56de\u503c",level:5},{value:"mergeComposer",id:"mergecomposer",level:4},{value:"\u53c2\u6570",id:"\u53c2\u6570-1",level:5},{value:"\u8fd4\u56de\u503c",id:"\u8fd4\u56de\u503c-1",level:5}];function V(e){const n={h3:"h3",h4:"h4",h5:"h5",li:"li",p:"p",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)(n.p,{children:[(0,t.jsx)("em",{children:"React.Context"})," \u751f\u6210\u5de5\u5177\uff0c\u5feb\u901f\u7ed1\u5b9a ",(0,t.jsx)("em",{children:"Provider"})," \u548c ",(0,t.jsx)("em",{children:"React.useContext"})," \u6570\u636e\u4f7f\u7528\uff0c\u540c\u65f6\u63d0\u4f9b\u591a ",(0,t.jsx)("em",{children:"React.Context"})," \u5408\u5e76\u80fd\u529b"]}),"\n","\n","\n",(0,t.jsx)(n.h3,{id:"\u5b89\u88c5",children:"\u5b89\u88c5"}),"\n",(0,t.jsx)(S.A,{name:"@jelper/context-composer"}),"\n",(0,t.jsx)(n.h3,{id:"\u6837\u4f8b",children:"\u6837\u4f8b"}),"\n",(0,t.jsx)(n.h4,{id:"\u5168\u5c40context\u4f7f\u7528",children:"\u5168\u5c40context\u4f7f\u7528"}),"\n",(0,t.jsx)(l.A,{title:"",desc:"",text:"import React, { JSX, useState } from 'react';\nimport { Input } from 'antd';\nimport createCtxComposer from '@jelper/context-composer';\n\n\ninterface ComposerParams {\n  hasBorder: boolean;\n}\ninterface HooksValue {\n  glabalType: string;\n  setGlabalType: (val: string) => void;\n}\n\ntype ForwardCom = ({ name }: { name: string }) => JSX.Element;\n\nconst opts = {\n  builder(props: ComposerParams, Com: ForwardCom) {\n    return <div style={{ border: props.hasBorder ? '1px solid #f60' : undefined, padding: '4px 12px' }}>\n      <Com name=\"base-api-test\" />\n    </div>\n  }\n}\n\nconst { forwardComposer, useComposerCtx } = createCtxComposer<ComposerParams, HooksValue>((props: ComposerParams) => {\n  const [glabalType, setGlabalType] = useState('light')\n  return {\n    glabalType,\n    setGlabalType,\n  }\n}, opts);\n\nconst TestCom = ({ name }: { name: string}) => {\n  const {glabalType, setGlabalType} = useComposerCtx();\n  return (\n    <>\n      <div>name: {name ?? '--'}</div>\n      <div>glabalType: {glabalType}</div>\n      <Input value={glabalType} onChange={(ev) => setGlabalType(ev.target.value)} />\n    </>\n  );\n};\n\nconst Demo = forwardComposer(TestCom)\n\nexport default () => <Demo hasBorder={true} />;\n\n\n",children:(0,t.jsx)(C,{})}),"\n",(0,t.jsx)(n.h4,{id:"\u591acontext\u5408\u5e76\u4f7f\u7528",children:"\u591acontext\u5408\u5e76\u4f7f\u7528"}),"\n",(0,t.jsx)(l.A,{title:"",desc:"",text:"import React, { useEffect, useState } from 'react';\nimport { Input } from 'antd';\nimport  {createCtxComposer, mergeComposer} from '@jelper/context-composer';\n\n\ninterface HooksParams {\n\n}\ninterface HooksValue {\n  glabalType: string;\n  setGlabalType: (val: string) => void;\n}\nconst { forwardComposer, useComposerCtx } = createCtxComposer<HooksParams, HooksValue>((props: HooksParams) => {\n  const [glabalType, setGlabalType] = useState('light')\n  return {\n    glabalType,\n    setGlabalType,\n  };\n});\n\nconst { forwardComposer: forwardComposer1, useComposerCtx: useComposerCtx1 } = createCtxComposer<HooksParams, HooksValue>((props: HooksParams) => {\n  const [glabalType1, setGlabalType1] = useState('light1')\n  return {\n    glabalType1,\n    setGlabalType1,\n  };\n});\n\nconst mergeforwardComposer = mergeComposer([\n  forwardComposer1,\n  forwardComposer,\n])\n\nconst TestCom = () => {\n  const {glabalType, setGlabalType} = useComposerCtx();\n  useEffect(() => {\n    console.log('TestCom----\x3e useEffect' )\n  }, []);\n  console.log('TestCom')\n  return (\n    <>\n      <div>glabalType: {glabalType}</div>\n      <Input value={glabalType} onChange={(ev) => setGlabalType(ev.target.value)} />\n      <br />\n    </>\n  );\n};\nconst TestCom1 = () => {\n  const {glabalType1, setGlabalType1} = useComposerCtx1();\n  useEffect(() => {\n    console.log('TestCom1----\x3e useEffect' )\n  }, []);\n  console.log('TestCom1')\n  return (\n    <>\n      <div>glabalType1: {glabalType1}</div>\n      <Input value={glabalType1} onChange={(ev) => setGlabalType1(ev.target.value)} />\n      <br />\n    </>\n  );\n};\n\nexport default mergeforwardComposer(() => {\n  useEffect(() => {\n    console.log('forwardComposer----\x3e useEffect' )\n  }, []);\n  console.log('forwardComposer');\n  return (<><TestCom /><TestCom1 /></>)\n});\n\n\n",children:(0,t.jsx)(k,{})}),"\n",(0,t.jsx)(n.h4,{id:"buildhooks\u4f7f\u7528",children:"buildHooks\u4f7f\u7528"}),"\n",(0,t.jsx)(l.A,{title:"",desc:"",text:"import React, { ReactEventHandler, useState } from 'react';\nimport { Input } from 'antd';\nimport createCtxComposer from '@jelper/context-composer';\n\n\ninterface HooksParams {\n\n}\ninterface HooksValue {\n  glabalType: string;\n  setGlabalType: (val: string) => void;\n}\nconst { forwardComposer, useComposerCtx, buildHooks } = createCtxComposer<HooksParams, HooksValue>((props: HooksParams) => {\n  const [glabalType, setGlabalType] = useState('light')\n  return {\n    glabalType,\n    setGlabalType,\n  }\n});\nconst useGlabalTypeState = buildHooks<string, [string, (p: string) => void]>(({ glabalType, setGlabalType }) => {\n  return (params: string) => {\n    return [glabalType, setGlabalType]\n  }\n});\n\nconst TestCom = () => {\n  const [type, setType] = useGlabalTypeState();\n  return (\n    <>\n      <div>glabalType: {type}</div>\n      <Input value={type} onChange={(ev) => setType(ev.target.value)} />\n    </>\n  );\n};\n\nexport default forwardComposer(TestCom);\n\n\n",children:(0,t.jsx)(F,{})}),"\n",(0,t.jsx)(n.h3,{id:"api",children:"API"}),"\n",(0,t.jsx)(n.h4,{id:"createctxcomposerprops-t",children:"createCtxComposer<Props, T>"}),"\n",(0,t.jsxs)(n.p,{children:["\u521b\u5efaReact.createContext, \u65b9\u4fbf ",(0,t.jsx)("em",{children:"Provider"})," \u5f15\u5165\u548c ",(0,t.jsx)("em",{children:"useContext"})," \u4f7f\u7528"]}),"\n",(0,t.jsx)(n.h5,{id:"\u53c2\u6570",children:"\u53c2\u6570"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"useCfgHook: (props: Props) => T"}),"\n",(0,t.jsxs)(n.li,{children:["opts?:","\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["builder?:  ","<T extends {} = P>(props: P, Com: FC<T>) => JSX.Element"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h5,{id:"\u8fd4\u56de\u503c",children:"\u8fd4\u56de\u503c"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"result<Object>"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"forwardComposer: (Com: FC<Props>) => FC<Props>"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"useComposerCtx: T"}),"\n"]}),"\n",(0,t.jsxs)(n.li,{children:["\n",(0,t.jsx)(n.p,{children:"buildHooks: <F extends (...arg: any) => any>(cb: (value: T) => F) => (...p: Parameters<F>) => ReturnType<F>;"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(n.h4,{id:"mergecomposer",children:"mergeComposer"}),"\n",(0,t.jsx)(n.h5,{id:"\u53c2\u6570-1",children:"\u53c2\u6570"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"list: Array<(Com: FC<Props>) => FC<Props>>"}),"\n"]}),"\n",(0,t.jsx)(n.h5,{id:"\u8fd4\u56de\u503c-1",children:"\u8fd4\u56de\u503c"}),"\n",(0,t.jsxs)(n.ul,{children:["\n",(0,t.jsx)(n.li,{children:"result: (Com: FC<Props>) => FC<Props>"}),"\n"]})]})}function B(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,t.jsx)(n,{...e,children:(0,t.jsx)(V,{...e})}):V(e)}}}]);