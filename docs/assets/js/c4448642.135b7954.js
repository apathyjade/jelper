"use strict";(self.webpackChunk_jelper_website=self.webpackChunk_jelper_website||[]).push([[4422],{9259:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>R,contentTitle:()=>F,default:()=>I,frontMatter:()=>E,metadata:()=>o,toc:()=>S});const o=JSON.parse('{"id":"context-composer/index","title":"context-composer","description":"React.Context \u751f\u6210\u5de5\u5177\uff0c\u5feb\u901f\u7ed1\u5b9a Provider \u548c React.useContext \u6570\u636e\u4f7f\u7528\uff0c\u540c\u65f6\u63d0\u4f9b\u591a React.Context \u5408\u5e76\u80fd\u529b","source":"@site/docs/context-composer/index.mdx","sourceDirName":"context-composer","slug":"/context-composer/","permalink":"/jelper/docs/context-composer/","draft":false,"unlisted":false,"editUrl":"https://github.com/apathyjade/jelper/tree/master/packages/docs/context-composer/index.mdx","tags":[],"version":"current","frontMatter":{"title":"context-composer","order":1},"sidebar":"tutorialSidebar","previous":{"title":"Row\u7ec4\u4ef6","permalink":"/jelper/docs/component/row/"},"next":{"title":"\u57fa\u7840\u6837\u5f0f\u7247\u6bb5","permalink":"/jelper/docs/css/"}}');var s=t(3274),r=t(4252),l=t(6220),a=t(9474),p=t(1722);const c=e=>{const n=a.createContext({});return{forwardComposer:(t,o)=>{const s=(0,a.memo)(t,o);return t=>{const o=e(t);return a.createElement(n.Provider,{value:o},a.createElement(s,Object.assign({},t)))}},useComposerCtx:()=>a.useContext(n),buildHooks:e=>(...t)=>{const o=a.useContext(n);return e(o)(...t)},ComposerCtx:n}},i=c,{forwardComposer:d,useComposerCtx:m}=i((e=>{const[n,t]=(0,a.useState)("light");return{glabalType:n,setGlabalType:t}})),u=d((()=>{const{glabalType:e,setGlabalType:n}=m();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{children:["glabalType: ",e]}),(0,s.jsx)(p.A,{value:e,onChange:e=>n(e.target.value)})]})})),{forwardComposer:x,useComposerCtx:C}=c((e=>{const[n,t]=(0,a.useState)("light");return{glabalType:n,setGlabalType:t}})),{forwardComposer:g,useComposerCtx:h}=c((e=>{const[n,t]=(0,a.useState)("light1");return{glabalType1:n,setGlabalType1:t}})),T=(b=[g,x],e=>b.reduce(((e,n)=>t=>{const o=n(e);return a.createElement(o,Object.assign({},t))}),e));var b;const v=()=>{const{glabalType:e,setGlabalType:n}=C();return(0,a.useEffect)((()=>{console.log("TestCom----\x3e useEffect")}),[]),console.log("TestCom"),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{children:["glabalType: ",e]}),(0,s.jsx)(p.A,{value:e,onChange:e=>n(e.target.value)}),(0,s.jsx)("br",{})]})},j=()=>{const{glabalType1:e,setGlabalType1:n}=h();return(0,a.useEffect)((()=>{console.log("TestCom1----\x3e useEffect")}),[]),console.log("TestCom1"),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{children:["glabalType1: ",e]}),(0,s.jsx)(p.A,{value:e,onChange:e=>n(e.target.value)}),(0,s.jsx)("br",{})]})},y=T((()=>((0,a.useEffect)((()=>{console.log("forwardComposer----\x3e useEffect")}),[]),console.log("forwardComposer"),(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(v,{}),(0,s.jsx)(j,{})]})))),{forwardComposer:f,useComposerCtx:k,buildHooks:G}=i((e=>{const[n,t]=(0,a.useState)("light");return{glabalType:n,setGlabalType:t}})),w=G((({glabalType:e,setGlabalType:n})=>t=>[e,n])),H=f((()=>{const[e,n]=w();return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("div",{children:["glabalType: ",e]}),(0,s.jsx)(p.A,{value:e,onChange:e=>n(e.target.value)})]})}));var P=t(6016);const E={title:"context-composer",order:1},F=void 0,R={},S=[{value:"\u5b89\u88c5",id:"\u5b89\u88c5",level:3},{value:"\u6837\u4f8b",id:"\u6837\u4f8b",level:3},{value:"\u5168\u5c40context\u4f7f\u7528",id:"\u5168\u5c40context\u4f7f\u7528",level:4},{value:"\u591acontext\u5408\u5e76\u4f7f\u7528",id:"\u591acontext\u5408\u5e76\u4f7f\u7528",level:4},{value:"buildHooks\u4f7f\u7528",id:"buildhooks\u4f7f\u7528",level:4},{value:"API",id:"api",level:3},{value:"createCtxComposer&lt;Props, T&gt;",id:"createctxcomposerprops-t",level:4},{value:"\u53c2\u6570",id:"\u53c2\u6570",level:5},{value:"\u8fd4\u56de\u503c",id:"\u8fd4\u56de\u503c",level:5},{value:"mergeComposer",id:"mergecomposer",level:4},{value:"\u53c2\u6570",id:"\u53c2\u6570-1",level:5},{value:"\u8fd4\u56de\u503c",id:"\u8fd4\u56de\u503c-1",level:5}];function A(e){const n={h3:"h3",h4:"h4",h5:"h5",li:"li",p:"p",ul:"ul",...(0,r.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(n.p,{children:[(0,s.jsx)("em",{children:"React.Context"})," \u751f\u6210\u5de5\u5177\uff0c\u5feb\u901f\u7ed1\u5b9a ",(0,s.jsx)("em",{children:"Provider"})," \u548c ",(0,s.jsx)("em",{children:"React.useContext"})," \u6570\u636e\u4f7f\u7528\uff0c\u540c\u65f6\u63d0\u4f9b\u591a ",(0,s.jsx)("em",{children:"React.Context"})," \u5408\u5e76\u80fd\u529b"]}),"\n","\n","\n",(0,s.jsx)(n.h3,{id:"\u5b89\u88c5",children:"\u5b89\u88c5"}),"\n",(0,s.jsx)(P.A,{name:"@jelper/context-composer"}),"\n",(0,s.jsx)(n.h3,{id:"\u6837\u4f8b",children:"\u6837\u4f8b"}),"\n",(0,s.jsx)(n.h4,{id:"\u5168\u5c40context\u4f7f\u7528",children:"\u5168\u5c40context\u4f7f\u7528"}),"\n",(0,s.jsx)(l.A,{title:"",desc:"",text:"import React, { useState } from 'react';\nimport { Input } from 'antd';\nimport createCtxComposer from '@jelper/context-composer';\n\n\ninterface HooksParams {\n\n}\ninterface HooksValue {\n  glabalType: string;\n  setGlabalType: (val: string) => void;\n}\nconst { forwardComposer, useComposerCtx } = createCtxComposer<HooksParams, HooksValue>((props: HooksParams) => {\n  const [glabalType, setGlabalType] = useState('light')\n  return {\n    glabalType,\n    setGlabalType,\n  }\n});\n\nconst TestCom = () => {\n  const {glabalType, setGlabalType} = useComposerCtx();\n  return (\n    <>\n      <div>glabalType: {glabalType}</div>\n      <Input value={glabalType} onChange={(ev) => setGlabalType(ev.target.value)} />\n    </>\n  );\n};\n\nexport default forwardComposer(TestCom);\n\n\n",children:(0,s.jsx)(u,{})}),"\n",(0,s.jsx)(n.h4,{id:"\u591acontext\u5408\u5e76\u4f7f\u7528",children:"\u591acontext\u5408\u5e76\u4f7f\u7528"}),"\n",(0,s.jsx)(l.A,{title:"",desc:"",text:"import React, { useEffect, useState } from 'react';\nimport { Input } from 'antd';\nimport  {createCtxComposer, mergeComposer} from '@jelper/context-composer';\n\n\ninterface HooksParams {\n\n}\ninterface HooksValue {\n  glabalType: string;\n  setGlabalType: (val: string) => void;\n}\nconst { forwardComposer, useComposerCtx } = createCtxComposer<HooksParams, HooksValue>((props: HooksParams) => {\n  const [glabalType, setGlabalType] = useState('light')\n  return {\n    glabalType,\n    setGlabalType,\n  };\n});\n\nconst { forwardComposer: forwardComposer1, useComposerCtx: useComposerCtx1 } = createCtxComposer<HooksParams, HooksValue>((props: HooksParams) => {\n  const [glabalType1, setGlabalType1] = useState('light1')\n  return {\n    glabalType1,\n    setGlabalType1,\n  };\n});\n\nconst mergeforwardComposer = mergeComposer([\n  forwardComposer1,\n  forwardComposer,\n])\n\nconst TestCom = () => {\n  const {glabalType, setGlabalType} = useComposerCtx();\n  useEffect(() => {\n    console.log('TestCom----\x3e useEffect' )\n  }, []);\n  console.log('TestCom')\n  return (\n    <>\n      <div>glabalType: {glabalType}</div>\n      <Input value={glabalType} onChange={(ev) => setGlabalType(ev.target.value)} />\n      <br />\n    </>\n  );\n};\nconst TestCom1 = () => {\n  const {glabalType1, setGlabalType1} = useComposerCtx1();\n  useEffect(() => {\n    console.log('TestCom1----\x3e useEffect' )\n  }, []);\n  console.log('TestCom1')\n  return (\n    <>\n      <div>glabalType1: {glabalType1}</div>\n      <Input value={glabalType1} onChange={(ev) => setGlabalType1(ev.target.value)} />\n      <br />\n    </>\n  );\n};\n\nexport default mergeforwardComposer(() => {\n  useEffect(() => {\n    console.log('forwardComposer----\x3e useEffect' )\n  }, []);\n  console.log('forwardComposer');\n  return (<><TestCom /><TestCom1 /></>)\n});\n\n\n",children:(0,s.jsx)(y,{})}),"\n",(0,s.jsx)(n.h4,{id:"buildhooks\u4f7f\u7528",children:"buildHooks\u4f7f\u7528"}),"\n",(0,s.jsx)(l.A,{title:"",desc:"",text:"import React, { ReactEventHandler, useState } from 'react';\nimport { Input } from 'antd';\nimport createCtxComposer from '@jelper/context-composer';\n\n\ninterface HooksParams {\n\n}\ninterface HooksValue {\n  glabalType: string;\n  setGlabalType: (val: string) => void;\n}\nconst { forwardComposer, useComposerCtx, buildHooks } = createCtxComposer<HooksParams, HooksValue>((props: HooksParams) => {\n  const [glabalType, setGlabalType] = useState('light')\n  return {\n    glabalType,\n    setGlabalType,\n  }\n});\nconst useGlabalTypeState = buildHooks<string, [string, (p: string) => void]>(({ glabalType, setGlabalType }) => {\n  return (params: string) => {\n    return [glabalType, setGlabalType]\n  }\n});\n\nconst TestCom = () => {\n  const [type, setType] = useGlabalTypeState();\n  return (\n    <>\n      <div>glabalType: {type}</div>\n      <Input value={type} onChange={(ev) => setType(ev.target.value)} />\n    </>\n  );\n};\n\nexport default forwardComposer(TestCom);\n\n\n",children:(0,s.jsx)(H,{})}),"\n",(0,s.jsx)(n.h3,{id:"api",children:"API"}),"\n",(0,s.jsx)(n.h4,{id:"createctxcomposerprops-t",children:"createCtxComposer<Props, T>"}),"\n",(0,s.jsxs)(n.p,{children:["\u521b\u5efaReact.createContext, \u65b9\u4fbf ",(0,s.jsx)("em",{children:"Provider"})," \u5f15\u5165\u548c ",(0,s.jsx)("em",{children:"useContext"})," \u4f7f\u7528"]}),"\n",(0,s.jsx)(n.h5,{id:"\u53c2\u6570",children:"\u53c2\u6570"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"useCfgHook: (props: Props) => T"}),"\n"]}),"\n",(0,s.jsx)(n.h5,{id:"\u8fd4\u56de\u503c",children:"\u8fd4\u56de\u503c"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"result<Object>"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"forwardComposer: (Com: FC<Props>) => FC<Props>"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"useComposerCtx: T"}),"\n"]}),"\n",(0,s.jsxs)(n.li,{children:["\n",(0,s.jsx)(n.p,{children:"buildHooks: <F extends (...arg: any) => any>(cb: (value: T) => F) => (...p: Parameters<F>) => ReturnType<F>;"}),"\n"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,s.jsx)(n.h4,{id:"mergecomposer",children:"mergeComposer"}),"\n",(0,s.jsx)(n.h5,{id:"\u53c2\u6570-1",children:"\u53c2\u6570"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"list: Array<(Com: FC<Props>) => FC<Props>>"}),"\n"]}),"\n",(0,s.jsx)(n.h5,{id:"\u8fd4\u56de\u503c-1",children:"\u8fd4\u56de\u503c"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"result: (Com: FC<Props>) => FC<Props>"}),"\n"]})]})}function I(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(A,{...e})}):A(e)}}}]);