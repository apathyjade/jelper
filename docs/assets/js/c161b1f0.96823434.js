"use strict";(globalThis.webpackChunk_jelper_website=globalThis.webpackChunk_jelper_website||[]).push([[229],{60858(e,r,i){i.r(r),i.d(r,{assets:()=>L,contentTitle:()=>f,default:()=>R,frontMatter:()=>P,metadata:()=>n,toc:()=>k});const n=JSON.parse('{"id":"di/index","title":"di","description":"\u5b89\u88c5","source":"@site/docs/di/index.mdx","sourceDirName":"di","slug":"/di/","permalink":"/jelper/docs/di/","draft":false,"unlisted":false,"editUrl":"https://github.com/apathyjade/jelper/tree/master/packages/docs/di/index.mdx","tags":[],"version":"current","frontMatter":{"title":"di","order":1},"sidebar":"tutorialSidebar","previous":{"title":"theme","permalink":"/jelper/docs/css/theme/"},"next":{"title":"enum","permalink":"/jelper/docs/enum/"}}');var o=i(71137),t=i(99868),l=i(56374);i(82437);const d=new Map,s=new Map,a=(e,...r)=>{const i=s.get(e.token)||d.get(e.type);if(!i)throw new Error(`No provider of type: ${e.type}`);if(i.useValue)return i.useValue;if(i.useFactory)return i.useFactory(...r);throw new Error(`Provider is damaged: ${String(i.token)}`)},m={token:Symbol("FormatLog"),type:"FormatLog",useValue:e=>`Log Formatted: ${e}`};var v;v=m,d.has(v.type)&&window.queueMicrotask(()=>{throw new Error(`Provider had set: ${v.type}`)}),d.set(v.type,v);const u={token:Symbol("FormatLog"),type:"FormatLog"},c={token:Symbol("FormatLog2"),type:"FormatLog"},h=a(u),p=a(c),g={token:Symbol("FormatTime"),type:"FormatTime",useValue:e=>`Time Formatted: ${e}`},j={token:Symbol("FormatTime"),type:"FormatTime"};((e,r)=>{s.set(e.token,r)})(j,g);const x=a(j),y=()=>(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{children:"\u901a\u7528Provider"}),(0,o.jsxs)("div",{children:["FormatLog: ",h("Hello World")," "]}),(0,o.jsxs)("div",{children:["FormatLog2: ",p("Hello World2")]}),(0,o.jsx)("div",{children:"relation \u6ce8\u518c Provider"}),(0,o.jsxs)("div",{children:["FormatTime: ",x("Hello World")]})]}),F=()=>(0,o.jsx)(y,{});var T=i(44310);const P={title:"di",order:1},f=void 0,L={},k=[{value:"\u5b89\u88c5",id:"\u5b89\u88c5",level:3},{value:"\u6837\u4f8b",id:"\u6837\u4f8b",level:3},{value:"di\u4f7f\u7528",id:"di\u4f7f\u7528",level:4},{value:"API",id:"api",level:3},{value:"setProvide",id:"setprovide",level:4},{value:"\u53c2\u6570",id:"\u53c2\u6570",level:5},{value:"\u8fd4\u56de\u503c",id:"\u8fd4\u56de\u503c",level:5},{value:"reletion",id:"reletion",level:4},{value:"\u53c2\u6570",id:"\u53c2\u6570-1",level:5},{value:"\u8fd4\u56de\u503c",id:"\u8fd4\u56de\u503c-1",level:5},{value:"getProvide&lt;T&gt;",id:"getprovidet",level:4},{value:"\u53c2\u6570",id:"\u53c2\u6570-2",level:5},{value:"\u8fd4\u56de\u503c",id:"\u8fd4\u56de\u503c-2",level:5},{value:"removeProvide",id:"removeprovide",level:4},{value:"\u53c2\u6570",id:"\u53c2\u6570-3",level:5},{value:"\u8fd4\u56de\u503c",id:"\u8fd4\u56de\u503c-3",level:5},{value:"removeRelation",id:"removerelation",level:4},{value:"\u53c2\u6570",id:"\u53c2\u6570-4",level:5},{value:"\u8fd4\u56de\u503c",id:"\u8fd4\u56de\u503c-4",level:5},{value:"\u7c7b\u578b Type",id:"\u7c7b\u578b-type",level:3}];function q(e){const r={code:"code",h3:"h3",h4:"h4",h5:"h5",li:"li",pre:"pre",ul:"ul",...(0,t.R)(),...e.components};return(0,o.jsxs)(o.Fragment,{children:[(0,o.jsx)(r.h3,{id:"\u5b89\u88c5",children:"\u5b89\u88c5"}),"\n",(0,o.jsx)(T.A,{name:"@jelper/di"}),"\n",(0,o.jsx)(r.h3,{id:"\u6837\u4f8b",children:"\u6837\u4f8b"}),"\n",(0,o.jsx)(r.h4,{id:"di\u4f7f\u7528",children:"di\u4f7f\u7528"}),"\n",(0,o.jsx)(l.A,{title:"",desc:"",text:"import React, { useState } from 'react';\nimport { Input } from 'antd';\nimport { setProvide, reletion, getProvide } from '@jelper/di';\n\nimport type { Provider, Require } from '@jelper/di';\n\n\ntype FormatLogRequireType = (str: string) => string;\ntype FormatLogProvider = Provider<FormatLogRequireType>;\n\n\nconst formatLogProvider: FormatLogProvider = {\n  token: Symbol('FormatLog'),\n  type: 'FormatLog',\n  useValue: (str: string) => {\n    return `Log Formatted: ${str}`;\n  }\n}\nsetProvide(formatLogProvider);\n\nconst formatLogRequire: Require = { token: Symbol('FormatLog'), type: 'FormatLog' }\nconst formatLogRequire2: Require = { token: Symbol('FormatLog2'), type: 'FormatLog' }\nconst formatLog = getProvide<FormatLogRequireType>(formatLogRequire);\nconst formatLog2 = getProvide<FormatLogRequireType>(formatLogRequire2);\n\ntype FormatTimeRequireType = (str: string) => string;\ntype FormatTimeProvider = Provider<FormatTimeRequireType>;\nconst formatTimeProvider: FormatTimeProvider = {\n  token: Symbol('FormatTime'),\n  type: 'FormatTime',\n  useValue: (str: string) => {\n    return `Time Formatted: ${str}`;\n  }\n}\nconst formatTimeRequire: Require = { token: Symbol('FormatTime'), type: 'FormatTime' }\nreletion(formatTimeRequire, formatTimeProvider);\nconst formatTime = getProvide<FormatTimeRequireType>(formatTimeRequire);\n\nconst TestCom = () => {\n  return (\n    <div>\n      <div>\u901a\u7528Provider</div>\n      <div>FormatLog: {formatLog('Hello World')} </div>\n      <div>FormatLog2: {formatLog2('Hello World2')}</div>\n      <div>relation \u6ce8\u518c Provider</div>\n      <div>FormatTime: {formatTime('Hello World')}</div>\n    </div>\n  );\n};\n\nexport default () => {\n  return (<TestCom />)\n};\n\n\n",children:(0,o.jsx)(F,{})}),"\n",(0,o.jsx)(r.h3,{id:"api",children:"API"}),"\n",(0,o.jsx)(r.h4,{id:"setprovide",children:"setProvide"}),"\n",(0,o.jsx)(r.h5,{id:"\u53c2\u6570",children:"\u53c2\u6570"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsx)(r.li,{children:"provider: Provider  \u63d0\u4f9b\u8005\u5bf9\u8c61"}),"\n"]}),"\n",(0,o.jsx)(r.h5,{id:"\u8fd4\u56de\u503c",children:"\u8fd4\u56de\u503c"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsx)(r.li,{children:"void"}),"\n"]}),"\n",(0,o.jsx)(r.h4,{id:"reletion",children:"reletion"}),"\n",(0,o.jsx)(r.h5,{id:"\u53c2\u6570-1",children:"\u53c2\u6570"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsx)(r.li,{children:"require: Require  \u4f9d\u8d56\u5bf9\u8c61"}),"\n",(0,o.jsx)(r.li,{children:"provider: Provider  \u63d0\u4f9b\u8005\u5bf9\u8c61"}),"\n"]}),"\n",(0,o.jsx)(r.h5,{id:"\u8fd4\u56de\u503c-1",children:"\u8fd4\u56de\u503c"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsx)(r.li,{children:"void"}),"\n"]}),"\n",(0,o.jsx)(r.h4,{id:"getprovidet",children:"getProvide<T>"}),"\n",(0,o.jsx)(r.h5,{id:"\u53c2\u6570-2",children:"\u53c2\u6570"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsx)(r.li,{children:"require: Require  \u4f9d\u8d56\u5bf9\u8c61"}),"\n",(0,o.jsx)(r.li,{children:"...args?: any[]  Provide\u4f7f\u7528useFactory\u65b9\u5f0f\u65f6, \u8c03\u7528\u4f20\u5165"}),"\n"]}),"\n",(0,o.jsx)(r.h5,{id:"\u8fd4\u56de\u503c-2",children:"\u8fd4\u56de\u503c"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsx)(r.li,{children:"T: require\u4f9d\u8d56, useValue\u503c\u7c7b\u578b \u6216\u8005 useFactory\u8fd4\u56de\u503c\u7c7b\u578b"}),"\n"]}),"\n",(0,o.jsx)(r.h4,{id:"removeprovide",children:"removeProvide"}),"\n",(0,o.jsx)(r.h5,{id:"\u53c2\u6570-3",children:"\u53c2\u6570"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsx)(r.li,{children:"type: string  \u63d0\u4f9b\u8005\u7c7b\u578b"}),"\n"]}),"\n",(0,o.jsx)(r.h5,{id:"\u8fd4\u56de\u503c-3",children:"\u8fd4\u56de\u503c"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsx)(r.li,{children:"void"}),"\n"]}),"\n",(0,o.jsx)(r.h4,{id:"removerelation",children:"removeRelation"}),"\n",(0,o.jsx)(r.h5,{id:"\u53c2\u6570-4",children:"\u53c2\u6570"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsx)(r.li,{children:"require: Require  \u4f9d\u8d56\u5bf9\u8c61"}),"\n"]}),"\n",(0,o.jsx)(r.h5,{id:"\u8fd4\u56de\u503c-4",children:"\u8fd4\u56de\u503c"}),"\n",(0,o.jsxs)(r.ul,{children:["\n",(0,o.jsx)(r.li,{children:"void"}),"\n"]}),"\n",(0,o.jsx)(r.h3,{id:"\u7c7b\u578b-type",children:"\u7c7b\u578b Type"}),"\n",(0,o.jsx)(r.pre,{children:(0,o.jsx)(r.code,{className:"language-typescript",children:"\ntype Token = string | symbol;\n\ntype Provider<T = any> = {\n  token: Token;\n  type: string;\n  useValue?: T;\n  useFactory?: (...arg: any[]) => T;\n}\n\ntype Require = {\n  token: Token;\n  type: string;\n}\n\n"})})]})}function R(e={}){const{wrapper:r}={...(0,t.R)(),...e.components};return r?(0,o.jsx)(r,{...e,children:(0,o.jsx)(q,{...e})}):q(e)}}}]);